(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,t,r){e.exports=r(267)},113:function(e,t,r){},114:function(e,t,r){},267:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(10),i=r.n(o),c=(r(113),r(21)),s=r(22),u=r(24),l=r(23),p=r(25),m=(r(114),r(28)),h=r(62),d=r.n(h),f=r(101),g=r(102),v=r(45),b=r(37),E=r.n(b),y=r(106),k=r.n(y),_=r(271),O=r(270),j=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).beautifyInput=function(e){return function(t){return"Registration Number"===e?t.toUpperCase():t.split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}).join(" ")}},r.updateInput=function(e){console.log(e.target),r.setState({value:r.beautifyInput(r.props.text)(e.target.value)}),r.props.update(e),console.log("child:",e.target.value)},r.popover=n.a.createElement(_.a,{styleid:"popover-basic"},r.props.popover),r.state={value:r.props.initialValue,errorText:r.props.errorText},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return console.log("error:",this.props.errorText),n.a.createElement("div",null,n.a.createElement(O.a,{trigger:"hover",placement:"right",overlay:this.popover},n.a.createElement(k.a,{label:this.props.text,value:this.state.value,onChange:function(t){return e.updateInput(t)},error:""!==this.props.errorText,helperText:""===this.props.errorText?"    ":this.props.errorText})))}}]),t}(n.a.Component),C=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={name:"",nameError:"",registration_number:"",registration_numberError:"",car_model:"",car_modelError:""},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=function(t){return function(r){e.setState(Object(v.a)({},t,r.target.value))}},r=function(){e.props.update()},a=function(){var t=!1,r={},a=e.state,n=a.name,o=a.registration_number,i=a.car_model;return/^[A-\xd6a-\xf6]*\s[A-\xd6a-\xf6]*$/.test(n)?/^[A-\xd6a-\xf6]*\s[A-\xd6a-\xf6]*$/.test(n)&&(r.nameError=""):(t=!0,r.nameError="Must contain firs- & last Name"),/^[a-\xf6A-\xd6]{3}\d{3}$/.test(o)?/^[a-\xf6A-\xd6]{3}\d{3}$/.test(o)&&(r.registration_numberError=""):(t=!0,r.registration_numberError="Must be in format: ABC123"),["volvo","saab"].includes(i.toLocaleLowerCase())?["volvo","saab"].includes(i.toLocaleLowerCase())&&(r.car_modelError=""):(t=!0,r.car_modelError='Should be "Saab" or "Volvo"'),t&&e.setState(Object(g.a)({},e.state,r)),t},o=function(){var t=Object(f.a)(d.a.mark(function t(n){var o,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),console.log(e.state.name),a()){t.next=10;break}return o="name=".concat(e.state.name,"&registration_number=").concat(e.state.registration_number,"&car_model=").concat(e.state.car_model),t.next=7,fetch("/userdata",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o}).then(function(e){return e.text()});case 7:i=t.sent,Object(m.bake_cookie)("access_key",i),r();case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return n.a.createElement("div",null,n.a.createElement("h2",null,"Register your Car information"),n.a.createElement("form",{onSubmit:function(e){return o(e)}},n.a.createElement(j,{text:"Name",initialValue:this.state.name,errorText:this.state.nameError,update:t("name"),popover:"Reuben Reubensson"}),n.a.createElement(j,{text:"Registration Number",initialValue:this.state.registration_number,errorText:this.state.registration_numberError,update:t("registration_number"),popover:"REU831"}),n.a.createElement(j,{text:"Car Model",initialValue:this.state.car_model,errorText:this.state.car_modelError,update:t("car_model"),popover:"Volvo"}),n.a.createElement(E.a,{type:"submit",onClick:o,color:"primary",variant:"contained"},"park")),n.a.createElement(E.a,{onClick:function(){return r()},raisedprimary:"false",size:"small"},"cancel"))}}]),t}(n.a.Component),w=r(64),x=r.n(w),A=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).userAccessKey=Object(m.read_cookie)("access_key"),r.getUserData=function(){36===r.userAccessKey.length&&(fetch("/userdata",{headers:{Authorization:"Bearer ".concat(r.userAccessKey)}}).then(function(e){return e.json()}).then(function(e){var t=e.length_of_visit-e.time_of_arrival,a=Math.floor(t/3600),n=Math.floor((t-3600*a)/60),o=t-3600*a-60*n,i=Math.round(t/3600*r.prize);r.setState({stayInMinutes:t,hours:a,minutes:n,seconds:o,prize:i})}).catch(function(e){return console.error(e)}),console.log("sending get request for data"))},r.deleteUserdata=function(){36===r.userAccessKey.length&&fetch("/userdata",{method:"DELETE",headers:{Authorization:"Bearer ".concat(r.userAccessKey)}})},r.prize=1200,r.goBack=function(){r.props.update()},r.pay=function(){Object(m.delete_cookie)("access_key"),r.deleteUserdata(),r.goBack()},r.componentWillMount=function(){setInterval(r.getUserData,1e3),r.getUserData()},r.state={stayInSeconds:0,hours:0,minutes:0,seconds:0,prize:0},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("p",null,"You have been here for ",this.state.hours," hours, ",this.state.minutes," minutes and ",this.state.seconds," seconds."),n.a.createElement("small",null,"Price is ",this.prize," SEK/h"),n.a.createElement("h2",null,"Good Bye"),n.a.createElement("div",null,n.a.createElement(x.a,{onClick:function(){e.pay()},variant:"dark",size:"lg"},"pay ",this.state.prize," kr"),n.a.createElement("br",null),n.a.createElement(x.a,{onClick:function(){return e.goBack()},variant:"danger",size:"sm"},"go back")))}}]),t}(n.a.Component),S=function(e){function t(){var e,r;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(r=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={login:!1,logout:!1},r.enterLogOutPage=function(){r.setState({logout:!0})},r.updateWholeState=function(){r.setState({login:!1,logout:!1})},r.displayContent=function(){if(r.state.login)return n.a.createElement(C,{update:r.updateWholeState});if(r.state.logout)return n.a.createElement(A,{update:r.updateWholeState});var e=36===Object(m.read_cookie)("access_key").length?n.a.createElement(E.a,{onClick:function(){return r.enterLogOutPage()}},"Check Out"):n.a.createElement(E.a,{onClick:function(){return r.enterLogInPage()},variant:"outlined",color:"primary"},"Check In");return n.a.createElement("div",null,n.a.createElement("h1",null,"Park Easy"),e)},r}return Object(p.a)(t,e),Object(s.a)(t,[{key:"enterLogInPage",value:function(){this.setState({login:!0})}},{key:"render",value:function(){var e=this.displayContent();return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"App-header"},e))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[108,1,2]]]);
//# sourceMappingURL=main.db4ae38f.chunk.js.map